<% content_for :head do %>
    <%= stylesheet_link_tag "accounts_config" %>
<% end %>

<div class="account_config">
    <% if notice && notice == '账号设置成功' %>
        <div class="alert alert-info" role="alert">
            <%= notice %>
        </div>
    <% end %>
    <div class="">
        <h3 class="config_title"><label>个人设置</label></h3>
    </div>

    <div class="">

        <%= form_for(current_user, url: accounts_update_path) do |f| %>
            <div class="form-group">
                <%= f.label :username, '用户名' %>
                <%= f.text_field :username, class: "form-control" %>
            </div>
            <div class="form-group">
                <%= f.label :email, '电子邮件' %>
                <%= f.email_field :email, autofocus: true, class: "form-control" %>
            </div>
            <div class="form-group">
                <%= f.label :real_name, '真实姓名' %>
                <%= f.text_field :real_name, autofocus: true, class: "form-control" %>
            </div>
            <div class="form-group">
                <%= f.label :phone, '联系电话' %>
                <%= f.text_field :phone, class: "form-control" %>
            </div>

            <div class="form-group actions text-right">
                <%= link_to "设置头像", "/accounts/config_avatar", class: "set_avatar" %>
                <%= f.submit '更新', class: 'btn btn-success' %>
            </div>
            <div class="form-group">
            </div>
        <% end %>
        <!--/div>
      </div-->
    </div>

    <div class="panel-footer bg-warning">
        <%= button_to "删除账户", registration_path(:user), data: {confirm: "确定删除账户?"}, class: 'btn btn-warning', method: :delete %>
    </div>
</div>

<%= content_for :foot do %>
    <%= javascript_include_tag 'plugins/validate/index' %>
    <script type="text/javascript">
        $(function () {
            $('form').validate({
                rules: {
                    "user[username]": {
                        required: true
                    },
                    "user[phone]": {
                        required: true,
                        isPhone: true
                    },
                    "user[email]": {
                        required: true,
                        email: true
                    }
                },
                messages: {
                    "user[username]": {
                        required: '请填写用户姓名'
                    },
                    "user[phone]": {
                        required: '请填写联系电话',
                        isPhone: '请填写正确的电话号码（固话含区号）'
                    },
                    "user[email]": {
                        required: '请填写电子邮件',
                        email: '请填写正确的电子邮件'
                    }
                },
                highlight: function (element) {   // <-- fires when element has error
                    $(element).closest('.form-group').removeClass('has-success').addClass('has-error');
                },
                unhighlight: function (element) { // <-- fires when element is valid
                    $(element).closest('.form-group').removeClass('has-error').addClass('has-success');
                },
                errorPlacement: function (error, element) {
                    error.appendTo(element.parent());
                }
            });
        })
    </script>
<% end %>
