var home = {};
home.index = 0;

$(function() {
  <%# home.category_tab_width = parseInt($(".category-tab").width()); %>
  <%# home.category_tab_height = parseInt($(".category-tab").height()); %>
  home.category_tab_width = 840;
  home.category_tab_height = 540;
  console.log("category tab width: " + home.category_tab_width);
  console.log("category tab height: " + home.category_tab_height);

  $('.indicator div').click(function() {
    if (home.handler)  clearTimeout(home.handler);
    home.index = parseInt($(this).data("index"));
    banner_switch(home.index);
  });
  home.handler = setTimeout(next, 5000);

  $('#category-list span').tooltip();

  category_init();
  $(".pre-btn").click(function() {
    horizonal_offset(".category-tabs", home.category_tab_width + 10);
  });

  $(".next-btn").click(function() {
    horizonal_offset(".category-tabs", -home.category_tab_width - 10);
  })
});

function banner_switch(index) {
  $(".indicator div.bg-white").removeClass("bg-white").addClass("bg-gray");
  home.s = ".indicator div:nth-child(" + (index+1) + ")";
  $this = $(home.s);
  $this.removeClass("bg-gray").addClass("bg-white");

  // temporary for two background image
  $(".banner-bg").toggleClass("bg-active").toggleClass("bg-inactive");

  home.handler = setTimeout(next, 5000);
}

function next() {
  home.index++;
  home.index %= 2;
  banner_switch(home.index);
}

function category_init() {
  $(".category-slider").height(home.category_tab_height);
  $(".category-viewport").width(home.category_tab_width);
  $(".category-tabs").height(home.category_tab_height);
  $(".category-tabs").width(10000);
  $(".inactive").css("top", -home.category_tab_height);
  $(".inactive").css("left", home.category_tab_width+10);
}

function horizonal_offset(selector, offset) {
  var old_val = parseInt($(selector).css("left"));
  var new_val = old_val + offset;
  $(selector).css("left", new_val);
}
